import{_ as s,c as i,o as a,a4 as h}from"./chunks/framework.Cohn-APp.js";const F=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"document/services/linux/运维常见场景操作.md","filePath":"document/services/linux/运维常见场景操作.md"}'),n={name:"document/services/linux/运维常见场景操作.md"},k=h(`<h2 id="crontab-定时任务" tabindex="-1">crontab 定时任务 <a class="header-anchor" href="#crontab-定时任务" aria-label="Permalink to &quot;crontab 定时任务&quot;">​</a></h2><h3 id="结束正在运行的定时任务" tabindex="-1">结束正在运行的定时任务 <a class="header-anchor" href="#结束正在运行的定时任务" aria-label="Permalink to &quot;结束正在运行的定时任务&quot;">​</a></h3><p>杀掉正在运行的 cron 进程就可以了，这里需要杀掉 received_feedback 任务</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ubuntu@titan</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hk:~$ ps </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ef </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grep cron</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">root       </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">732</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  2022</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">04</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">36</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> /</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">usr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sbin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cron </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-f</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ubuntu    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1920</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  1913</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 14</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">00</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> /</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sh </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">c </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bash </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">c </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;export PATH=/home/ubuntu/bin:/home/ubuntu/.rbenv/shims:/home/ubuntu/.rbenv/bin:/usr/bin:$PATH; eval &quot;$(rbenv init -)&quot;; cd /home/ubuntu/Titan &amp;&amp; RAILS_ENV=production bundle exec rake cron:received_feedback --silent &gt;&gt; /home/ubuntu/Titan/log/cron.log 2&gt;&amp;1&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ubuntu    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1924</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  1920</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 14</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">00</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> /</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bash </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">l </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">c export PATH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">home</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ubuntu</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bin:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">home</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ubuntu</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.rbenv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">shims:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">home</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ubuntu</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.rbenv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bin:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">usr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bin:$PATH; eval </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">(rbenv init </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; cd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">home</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ubuntu</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Titan &amp;&amp; RAILS_ENV</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">production bundle exec rake cron:received_feedback </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">silent </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> /</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">home</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ubuntu</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Titan</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">log</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">cron.log </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">2&gt;&amp;1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ubuntu    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2044</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  1924</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 14</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> /</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">home</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ubuntu</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.rbenv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">versions</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rake cron:received_feedback </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">silent</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ubuntu    </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2826</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  2646</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 14</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">36</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pts</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">00</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grep </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">color</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">auto cron</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ubuntu@titan</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hk:~$ kill </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2044</span></span></code></pre></div><h2 id="查看系统运行情况" tabindex="-1">查看系统运行情况 <a class="header-anchor" href="#查看系统运行情况" aria-label="Permalink to &quot;查看系统运行情况&quot;">​</a></h2><h3 id="iftop-查看宽带占用情况" tabindex="-1">iftop 查看宽带占用情况 <a class="header-anchor" href="#iftop-查看宽带占用情况" aria-label="Permalink to &quot;iftop 查看宽带占用情况&quot;">​</a></h3><p>界面上面显示的是类似刻度尺的刻度范围，为显示流量图形的长条作标尺用的。中间的 &lt;= (接收流量) =&gt; (发送流量) 这两个左右箭头，表示的是流量的方向.</p><details class="details custom-block"><summary>iftop运行相关参数说明</summary><p>-i 设定监测的网卡，如：# iftop -i eth1<br> -B 以bytes为单位显示流量(默认是bits)，如：# iftop -B<br> -n 使host信息默认直接都显示IP，如：# iftop -n<br> -N 使端口信息默认直接都显示端口号，如: # iftop -N<br> -F 显示特定网段的进出流量，如# iftop -F 172.30.1.0/24或# iftop -F 172.30.1.0/255.255.255.0<br> -h（display this message），帮助，显示参数信息<br> -p 使用这个参数后，中间的列表显示的本地主机信息，出现了本机以外的IP信息;<br> -b 使流量图形条默认就显示;<br> -f 这个暂时还不太会用，过滤计算包用的;<br> -P 使host信息及端口信息默认就都显示;<br> -m 设置界面最上边的刻度的最大值，刻度分五个大段显示，例：# iftop -m 100M</p></details><details class="details custom-block"><summary>iftop画面后的一些操作命令</summary><p>按 h 切换是否显示帮助;<br> 按 n 切换显示本机的IP或主机名;<br> 按 s 切换是否显示本机的host信息;<br> 按 d 切换是否显示远端目标主机的host信息;<br> 按 t 切换显示格式为2行/1行/只显示发送流量/只显示接收流量;<br> 按 N 切换显示端口号或端口服务名称;<br> 按 S 切换是否显示本机的端口信息;<br> 按 D 切换是否显示远端目标主机的端口信息;<br> 按 p 切换是否显示端口信息;<br> 按 P 切换暂停/继续显示;<br> 按 b 切换是否显示平均流量图形条;<br> 按 B 切换计算2秒或10秒或40秒内的平均流量;<br> 按 T 切换是否显示每个连接的总流量;<br> 按 l 打开屏幕过滤功能，输入要过滤的字符，比如ip,按回车后，屏幕就只显示这个IP相关的流量信息;<br> 按 L 切换显示画面上边的刻度;刻度不同，流量图形条会有变化;<br> 按 j 或按k可以向上或向下滚动屏幕显示的连接记录;<br> 按 1 或2或3可以根据右侧显示的三列流量数据进行排序;<br> 按 &lt; 根据左边的本机名或IP排序;<br> 按 &gt; 根据远端目标主机的主机名或IP排序;<br> 按 o 切换是否固定只显示当前的连接;<br> 按 f 可以编辑过滤代码，这是翻译过来的说法，我还没用过这个！<br> 按 ! 可以使用shell命令，这个没用过！没搞明白啥命令在这好用呢！<br> 按 q 退出监控。</p></details><div class="tip custom-block"><p class="custom-block-title">iftop界面的参数说明</p><p>TX：发送流量<br> RX：接收流量<br> TOTAL：总流量<br> cum：运行 iftop 到目前时间的总流量<br> peak：流量峰值<br> rates：分别表示过去 2s 10s 40s 的平均流量</p></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>ubuntu@es-cn-sz-4:~$ sudo iftop -i eth0 -P -m 15M</span></span>
<span class="line"><span>interface: eth0</span></span>
<span class="line"><span>IP address is: 172.18.236.168</span></span>
<span class="line"><span>MAC address is: 00:16:3e:06:72:66</span></span>
<span class="line"><span></span></span>
<span class="line"><span>                                   19.1Mb                              38.1Mb                             57.2Mb                              76.3Mb                        95.4Mb</span></span>
<span class="line"><span>└──────────────────────────────────┴───────────────────────────────────┴──────────────────────────────────┴───────────────────────────────────┴───────────────────────────────────</span></span>
<span class="line"><span>172.18.236.168:https                                                        =&gt; 140.249.254.175:46864                                                        432Kb   301Kb   139Kb</span></span>
<span class="line"><span>                                                                            &lt;=                                                                             7.02Kb  4.54Kb  2.18Kb</span></span>
<span class="line"><span>172.18.236.168:https                                                        =&gt; 120.72.63.142:50478                                                          187Kb   278Kb   168Kb</span></span>
<span class="line"><span>                                                                            &lt;=                                                                             3.03Kb  4.23Kb  2.50Kb</span></span>
<span class="line"><span>172.18.236.168:https                                                        =&gt; 119.167.234.119:53967                                                       99.3Kb   271Kb  82.1Kb</span></span>
<span class="line"><span>                                                                            &lt;=                                                                             1.08Kb  4.11Kb  1.19Kb</span></span>
<span class="line"><span></span></span>
<span class="line"><span>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></span>
<span class="line"><span>TX:             cum:    299MB   peak:   19.5Mb                                                                                                    rates:   15.3Mb  17.7Mb  17.6Mb</span></span>
<span class="line"><span>RX:                    5.75MB            437Kb                                                                                                              285Kb   320Kb   326Kb</span></span>
<span class="line"><span>TOTAL:                  305MB           19.8Mb                                                                                                             15.6Mb  18.0Mb  17.9M</span></span></code></pre></div>`,11),t=[k];function p(l,e,r,E,d,g){return a(),i("div",null,t)}const b=s(n,[["render",p]]);export{F as __pageData,b as default};
